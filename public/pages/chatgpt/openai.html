<!DOCTYPE html>
<html>
  <head>
    <title>Chatbot Example</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="style.css">
  </head>
  <body>
    <section class="msger">
        <header class="msger-header">
          <div class="msger-header-title">
            <img src="robot.png" alt="" srcset="">
            <p>ChatBot</p>
          </div>
        </header>
        <main class="msger-chat" id="chat-log">
          <div class="msg left-msg">
            <div
             class="msg-img"
             style="background-image: url(bot.png)"
            ></div>
            <div class="msg-bubble">
              <div class="msg-info">
                <div class="msg-info-name">BOT</div>
                <div class="msg-info-time">12:45</div>
              </div>
              <div class="msg-text">
                 Go ahead and send me a message.
              </div>
            </div>
          </div>
        </main>
        <form class="msger-inputarea" id="chat-form">
          <label for="message-input">Message:</label>
          <input type="text" id="message-input" class="msger-input" name="message" placeholder="Enter your message..." required>
          <button type="submit" class="msger-send-btn"><i class="fa fa-paper-plane"></i></button>
        </form>
      </section>

    <script>
      const chatForm = document.getElementById('chat-form');
      const messageInput = document.getElementById('message-input');
      const chatLog = document.getElementById('chat-log');

      chatForm.addEventListener('submit', (event) => {
        event.preventDefault();
        const message = messageInput.value;

        const messageEl = document.createElement('div');
        messageEl.className = 'message';
        messageEl.textContent = `You: ${message}`;
        chatLog.appendChild(messageEl);

        fetch('/chat', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({ message }),
        })
          .then((res) => res.json())
          .then((data) => {
            const reply = data.reply;
            const replyEl = document.createElement('div');
            replyEl.className = 'reply';
            replyEl.textContent = `Chatbot: ${reply}`;
            chatLog.appendChild(replyEl);
            chatLog.scrollTop = chatLog.scrollHeight;
          });

        messageInput.value = '';
      });
    </script>
  </body>
</html>
